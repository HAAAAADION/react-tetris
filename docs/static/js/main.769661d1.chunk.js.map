{"version":3,"sources":["App.js","config/constant.js","utils/utils.js","utils/store.js","utils/shape.js","utils/bus.js","component/cube/index.js","component/game/index.js","component/next/index.js","component/info/index.js","component/game-area/index.js","component/control/index.js","utils/disable-zoom.js","serviceWorker.js","store/index.js","store/home.js","index.js"],"names":["keyupListener","timeY","STATE","COL_SIZE","KEY_CODE_DIRECTION","SPACE","LEFT","RIGHT","DOWN","KEY_CODE_DIRECTION_SEED","EVENT_KEY","getShapeSize","shape","length","getShapeHalfSize","Math","floor","slice","arr","size","result","i","push","isEmpty","v","Object","prototype","toString","call","keys","undefined","isMobile","test","navigator","userAgent","dispatch","payload","window","_dva","_store","updateState","type","setX","x","setY","y","updateScore","getState","this","state","home","reverse","nextShape","_getSafeRang","row","p","reduce","item","min","max","getShape","key","shapeList","parseInt","random","checkCollision","nx","ny","newShape","store","body","computedShape","newBody","map","e","loop","k","yIndex","cX","checkStop","Bus","funs","on","fn","emit","props","off","bus","className","cx","connect","useState","nextArea","setNextArea","useEffect","nextAreaContent","Array","ROW_SIZE","fill","forEach","score","Btn","text","onTouchStart","pushProps","onMouseDown","change","down","getYStop","cy","handleDirection","keyCode","longestSide","sizeArr","getShapeLongestRowSide","computedX","newX","left","right","isStart","onKeyUp","values","includes","start","currentShape","nextState","beforeStart","document","addEventListener","eliminate","indexs","Promise","resolev","setTimeout","splice","unshift","handleEnd","clearTimer","resetAnimation","num","seed","total","cNum","cSeed","nextNum","cState","console","log","handleCount","isStop","a","newMatrix","index","every","isEliminate","some","updateShape","event","preventDefault","lastTouchEnd","documentElement","now","Date","disableZoom","changeSizeX","changeSizeY","colLength","lastPointX","findIndex","rowX","rowY","sizeX","sizeY","assign","getShapeSafeRange","safeRangeX","safeRangeY","newShapeSize","boundaryFix","clearTimeout","Boolean","location","hostname","match","stores","namespace","reducers","effects","put","createStore","app","model","dva","router","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.769661d1.chunk.js","sourcesContent":["import React, { useEffect } from 'react';\nimport { connect } from 'dva';\nimport { STATE, COL_SIZE, KEY_CODE_DIRECTION, EVENT_KEY } from 'config/constant';\nimport { getShape, checkStop, getShapeSafeRange, resetAnimation } from 'utils/shape';\nimport store from 'utils/store';\nimport { slice, boundaryFix, getShapeSize, getShapeHalfSize, isEmpty } from 'utils/utils';\nimport { bus } from 'utils/bus';\nimport disableZoom from 'utils/disable-zoom';\nimport GameArea from 'component/game-area';\nimport Control from 'component/control';\nimport './App.scss';\n\n// keyup 监听器\nlet keyupListener;\n// 是否已经开始\nlet isStart = false;\n// 计时器\nlet timeY;\n// 下落间隔实践\nlet TIME_DURATION = 500;\n\nconst App = (props) => {\n  const { body, x, y, shape, nextShape } = props;\n\n  const onKeyUp = (e) => {\n    if (!isStart) return;\n\n    const { keyCode } = e;\n\n    if (!Object.values(KEY_CODE_DIRECTION).includes(keyCode)) return;\n\n    bus.emit(keyCode, { keyCode });\n  };\n\n  const start = () => {\n    if (!isStart) return;\n\n    const currentShape = isEmpty(nextShape) ? getShape() : nextShape;\n\n    const nextState = { \n      y: 0,\n      shape: currentShape,\n      nextShape: getShape(),\n      x: Math.floor((COL_SIZE - 1) / 2) - getShapeHalfSize(currentShape),\n    };\n\n    store.updateState(nextState);\n  };\n\n  const beforeStart = () => {\n    if (isStart) return;\n\n    if (!keyupListener) {\n      keyupListener = onKeyUp;\n      document.addEventListener('keyup', onKeyUp);\n    }\n\n    isStart = true;\n\n    start();\n  };\n\n  /**\n   * 清除\n   * @param {Array} indexs    需要清除的下标\n   * @param {Array} newBody   当前画布\n   */\n  const eliminate = (indexs, newBody) => {\n    return new Promise((resolev) => {\n      // TODO 动画\n\n      setTimeout(() => {\n        indexs.forEach(e => {\n          newBody.splice(e * COL_SIZE, COL_SIZE);\n          newBody.unshift(...Array(COL_SIZE).fill('0'));\n        });\n\n        resolev();\n      }, 3000);\n    });\n  };\n\n  /**\n   * 游戏结束\n   */\n  const handleEnd = () => {\n    clearTimer();\n\n    resetAnimation();\n\n    isStart = false;\n    console.log('游戏结束');\n  };\n\n  /**\n   * 结算\n   * @param {Array} newBody   当前画布\n   */\n  const handleCount = async (newBody, isStop) => {\n    const newMatrix = slice(newBody, COL_SIZE);\n\n    // 到底停止\n    if (isStop) clearTimer();\n\n    // 检测是否执行消除\n    const indexs = newMatrix.reduce((result, item, index) => {\n      const isFull = item.every(e => e === '2');\n      if (isFull) result.push(index);\n      return result;\n    }, []);\n\n    // 是否需要清除\n    const isEliminate = indexs.length > 0;\n\n    // 清除逻辑\n    if (isEliminate) {\n      // 清除计时器\n      clearTimer();\n\n      console.log('正在执行消除, 下标集合: ', indexs);\n\n      await eliminate(indexs, newBody);\n      // 更新分数\n      store.updateScore(indexs.length);\n    }\n\n    // 更新画布\n    store.updateState({ body: [...newBody] });\n\n    // 是否结束\n    const isEnd = newBody.slice(0, 10).some(e => e === STATE.COMPLETE);\n\n    if (isEnd) handleEnd();         // 游戏结束\n    else if (isEliminate) start();  // 消除\n    else if (isStop) start();       // 继续\n  };\n\n  /**\n   * 更新位置\n   */\n  const updateShape = () => {\n    const newBody = body.map(e => e ===  STATE.PROGRESS ? STATE.EMPTY : e);\n\n    // 是否停止\n    const isStop = checkStop(x, y);\n    // 当前 y\n    const ny = isStop ? y - 1 : y;\n\n    shape.forEach((e, i) => {\n      e.forEach((v, k) => {\n        if (v === 1) {\n          const yIndex = (ny - i) * COL_SIZE;\n          newBody[yIndex + x + k] = isStop ? STATE.COMPLETE : STATE.PROGRESS;\n        }\n      })\n    });\n\n    store.updateState({ body: newBody });\n    handleCount(newBody, isStop);\n  };\n\n  useEffect(() => {\n    if (!isStart) return;\n\n    clearTimer();\n\n    timeY = setTimeout(() => {\n      store.setY(y + 1);\n    }, TIME_DURATION);\n  }, [y]);\n\n  useEffect(() => {\n    if (!isStart) return;\n    updateShape();\n  }, [x, y, shape]);\n\n  useEffect(() => {\n    bus.on(EVENT_KEY.START_GAME, beforeStart);\n    bus.on(EVENT_KEY.RESET_GAME, handleEnd);\n    bus.on(EVENT_KEY.SHAPE_CHANGE, change);\n\n    disableZoom();\n  }, []);\n\n  const change = () => {\n    if (!isStart) return;\n\n    const { x, y } = store?.state?.home || {};\n\n    // 测试形状\n    // const example = [\n    //   [0, 1, 1],\n    //   [1, 1, 1],\n    // ];\n\n    const { currentShape } = store;\n\n    // 一维长度 = 变形后的 x 长度\n    const changeSizeX = currentShape.length;\n    // 二维长度 = 变形后的 y 长度\n    const changeSizeY = currentShape[0].length - 1;\n\n    // 安全位置\n    const { x: safeRangeX, y: safeRangeY } = getShapeSafeRange();\n\n    if (\n      // x 超过安全位置\n      (safeRangeX.max - safeRangeX.min < changeSizeX - 1) ||\n      // y 超过安全位置\n      (y >= changeSizeY && y - safeRangeY.min < changeSizeY)\n    ) {\n      return;\n    }\n\n    // 变形后形状\n    const newShape = currentShape.reduce((result, item, i) => {\n      item.forEach((v, k) => {\n        if (!result[k]) result[k] = Array(currentShape.length);\n\n        result[k][currentShape.length - 1 - i] = v;\n      });\n\n      return result;\n    }, []);\n\n    // 新形状长度\n    const newShapeSize = getShapeSize(newShape);\n    // 计算后的 x\n    const computedX = x + getShapeHalfSize(currentShape) - Math.floor(newShapeSize / 2);\n\n    const min = safeRangeX.min;\n    const max = safeRangeX.max - newShapeSize + 1;\n\n    // x 兼容边界溢出\n    const newX = boundaryFix(computedX, min, max);\n\n    store.updateState({\n      shape: [...newShape].reverse(),\n      x: newX,\n    });\n  };\n\n  /**\n   * 清除计时器\n   */\n  const clearTimer = () => {\n    if (timeY) {\n      clearTimeout(timeY);\n      timeY = null;\n    }\n  };\n\n  return (\n    <div className=\"index\">\n      <div className=\"index__container\">\n        <GameArea />\n        <Control />\n      </div>\n    </div>\n  );\n}\n\nexport default connect(({\n  home,\n}) => (home))(App);\n","// 状态\nexport const STATE = {\n  EMPTY: '0',\n  PROGRESS: '1',\n  COMPLETE: '2',\n};\n\n// 列数\nexport const COL_SIZE = 10;\n\n// 每次消除分数\nexport const SCORE_SIZE = 10;\n\n// 键盘方向\nexport const KEY_CODE_DIRECTION = {\n  SPACE: 32,\n  LEFT: 37,\n  RIGHT: 39,\n  DOWN: 40,\n};\n\n// 方向种子数\nexport const KEY_CODE_DIRECTION_SEED = {\n  [KEY_CODE_DIRECTION.LEFT]: -1,\n  [KEY_CODE_DIRECTION.RIGHT]: 1\n}\n\n// 全局广播 key\nexport const EVENT_KEY = {\n  START_GAME: 'START_GAME',\n  RESET_GAME: 'RESET_GAME',\n  SHAPE_CHANGE: 'SHAPE_CHANGE',\n  SHAPE_LEFT: 'SHAPE_LEFT',\n  SHAPE_RIGHT: 'SHAPE_RIGHT',\n  SHAPE_DOWN: 'SHAPE_DOWN',\n};","/**\n * 获取范围随机数\n * @param   {Number}  min 最小值\n * @param   {Number}  max 最大值\n * @return  {Number}      随机数\n */\nexport const getRandom = (min, max) => parseInt(Math.random() * (max - min + 1) + min, 10);\n\n/**\n * 边界判断\n * @param   {Number}  min 最小值\n * @param   {Number}  max 最大值\n */\nexport const boundaryFix = (num, min, max) => num < min ? min : num > max ? max : num;\n\n/**\n * 获取形状边长\n * @param   {Array}   shape 形状数据\n * @returns {Number}        边长\n */\nexport const getShapeSize = (shape) => shape?.[0]?.length || 0;\n\n/**\n * 获取形状边长的一半\n * @param   {Array}   shape 形状数据\n * @returns {Number}        边长一半\n */\nexport const getShapeHalfSize = (shape) => Math.floor(getShapeSize(shape) / 2);\n\n/**\n * 分割数组\n * @param   {Array} arr   目标数组\n * @param   {Array} size  分割数组长度\n * @return  {Array}       分割后数组 \n */\nexport const slice = (arr, size) => {\n  const result = [];\n  for (let i = 0; i < arr.length / size; i++) {\n    result.push(arr.slice(size * i, size * i + size));\n  }\n\n  return result;\n};\n\n/**\n * 获取形状横向最长的边\n * @param   {Array}   shape 形状矩阵\n * @return  {Number}        最长边占位  \n */\nexport const getShapeLongestRowSide = (shape) => {\n  const sizeArr = shape.map(e => e.length);\n  return Math.max(...sizeArr);\n};\n\n/**\n * 内容是否为空\n * @param   {*} v     判断数据内容\n * @return  {Boolean} 是否为空\n */\nexport const isEmpty = (v) => {\n  const objType = Object.prototype.toString.call(v);\n \n  switch (objType) {\n    case '[object Array]':\n      return v.length <= 0;\n    case '[object Object]':\n      return Object.keys(v).length <= 0;\n    default:\n      return v === undefined;\n  }\n};\n\n/**\n * 是否手机\n */\nexport const isMobile = () => /Android|webOS|iPhone|iPad|BlackBerry/i.test(navigator.userAgent);\n","const dispatch = (payload) => {\n  window._dva._store.dispatch(payload);\n};\n\nconst updateState = (payload) => {\n  dispatch({\n    type: 'home/updateState',\n    payload,\n  });\n};\n\nconst setX = (x) => {\n  dispatch({\n    type: 'home/setX',\n    payload: { x },\n  });\n};\n\nconst setY = (y) => {\n  dispatch({\n    type: 'home/setY',\n    payload: { y },\n  });\n};\n\nconst updateScore = (size = 0) => {\n  dispatch({\n    type: 'home/updateScore',\n    payload: { size },\n  });\n};\n\nexport default {\n  updateState,\n  setX,\n  setY,\n  updateScore,\n  get state () { \n    return window?._dva?._store?.getState();\n   },\n\n   get currentShape () {\n     return [...this.state.home.shape].reverse();\n   },\n\n   get nextShape () {\n    return [...this.state.home.nextShape].reverse();\n  },\n};","import { COL_SIZE, STATE } from 'config/constant';\nimport shapeList from 'config/shape.json';\nimport { getRandom, slice } from './utils';\nimport store from './store';\n\n/**\n * 获取当前水平/垂直安全位置\n * @param   {Array}     row 判断数据\n * @param   {Number}    p   当前坐标, [x, y]\n * @return  {Object}        安全位置数据, {min, max}\n */\nconst _getSafeRang = (row, p) => {\n    return row.reduce((result, item, i) => {\n        if (item === STATE.COMPLETE) {\n            if (i <= p) result.min = i + 1;\n            else if (i > p && result.max === undefined) result.max = i - 1;\n        }\n\n        return result;\n    }, {});\n};\n\n// 因为渲染的原因, 所有每个图形返回时都要反转一下\nexport const getShape = () => {\n    const key = getRandom(0, shapeList.length - 1);\n    // const key = 0;\n\n    const shape = shapeList[key];\n    return [...shape].reverse();\n}\n\n/**\n * 判断下一个位置是否碰撞\n * @param   {Number}  nx            检查 x\n * @param   {Number}  ny            检查 y\n * @param   {Array=}  newShape      当前形状\n * @return  {Boolean | Object}      是否碰撞 | 碰撞坐标\n */\nexport const checkCollision = (nx, ny, newShape) =>  {\n    const { shape = [], body = [] } = store?.state?.home || {};\n    const computedShape = newShape || shape;\n    let result = false;\n\n    const newBody = body.map(e => e ===  STATE.PROGRESS ? STATE.EMPTY : e);\n\n    loop:\n    for(let i = 0; i < computedShape.length; i += 1)  {\n        for(let k = 0; k < computedShape[i].length; k += 1) {\n        const yIndex = (ny - i) * COL_SIZE;\n\n        // 当前 x\n        const cX = nx + k;\n        if (computedShape[i][k] === 1 && newBody[yIndex + cX] === STATE.COMPLETE) {\n            result = { x: cX, y: yIndex };\n            break loop;\n        }\n        }\n    }\n\n    return result;\n};\n\n/**\n * 判断是否停止\n * @param   {Number}  nx  当前 x\n * @param   {Number}  ny  当前 y\n * @return  {Boolean}     是否停止(是否到底 || 下一个位置是否碰撞)\n */\nexport const checkStop = (nx, ny) => {\n    const { body = [] } = store?.state?.home || {};\n    const matrix = slice(body, COL_SIZE);\n\n    return ny >= matrix.length || checkCollision(nx, ny);\n}\n\n/**\n * 获取相对与当前 x y 最后要停止的 y 的位置\n * @param   {Number=}  ny   当前 y\n * @return  {Number}        y 应该停止的位置\n */\nexport const getYStop = (ny) => {\n    const { x = 0, y = 0 } = store?.state?.home || {};\n    const  cy = ny || y;\n\n    return checkStop(x, cy) ? cy - 1 : getYStop(cy + 1);\n}\n\n/**\n * 获取当前可用安全位置(x, y)\n * @return  {OPbject}   x, y 安全距离\n */\nexport const getShapeSafeRange = () => {\n    const { x, y, body } = store?.state?.home || {};\n\n    // 画布垂直长度\n    const colLength = slice(body, COL_SIZE).length;\n    // 当前形状最后一行的起始的 x 位置\n    const lastPointX = store.currentShape[store.currentShape.length - 1].findIndex(e => e === 1);\n\n    // 当前行数据\n    const rowX = body.slice(y * COL_SIZE, y * COL_SIZE + COL_SIZE);\n    // 当前列数据\n    const rowY = Array(colLength).fill('0').map((e, i) => body[(i * COL_SIZE) + x + lastPointX]);\n\n    // 水平安全位置\n    const sizeX = _getSafeRang(rowX, x);\n    // 垂直安全位置\n    const sizeY = _getSafeRang(rowY, y);\n\n    return {\n        x: Object.assign({ min: 0, max: COL_SIZE - 1 }, sizeX),\n        y: Object.assign({ min: 0, max: colLength - 1 }, sizeY),\n    };\n};\n\n/**\n * 清除画布动画\n * @param   {Number=}   num     当前 y\n * @param   {Number=}   seed    递归种子数, [-1, 1]\n */\nexport const resetAnimation = (num, seed = -1) => {\n    const { body } = store.state.home;\n\n    const total = slice(body, COL_SIZE).length - 1;\n    const cNum = num !== undefined ? num : total;\n    const cSeed = cNum <= 0 ? 1 : seed;\n    const nextNum = cNum + seed < 0 ? 0 : cNum + cSeed;\n    const cState = seed > 0 ? STATE.EMPTY : STATE.COMPLETE;\n    \n    if (cNum > total) return;\n\n    const yIndex = cNum * COL_SIZE;\n    body.splice(yIndex, COL_SIZE, ...Array(COL_SIZE).fill(cState));\n\n    store.updateState({ body: [...body] });\n\n    setTimeout(() => {\n        resetAnimation(nextNum, cSeed);\n    }, 50);\n  };\n","class Bus {\n  funs = {};\n\n  on = (key, fn) => {\n    this.funs[key] = fn;\n  };\n\n  emit = (key, props) => {\n    if (!this.funs[key]) return;\n\n    this.funs[key](props);\n  };\n\n  off = (key) => {\n    delete this.funs[key];\n  };\n}\n\nexport const bus = new Bus();\nexport default Bus;\n","import React from 'react';\nimport cx from 'classname';\nimport { STATE } from 'config/constant';\nimport './index.scss';\n\nexport default (props) => {\n  const { type } = props;\n\n  return (\n    <div\n      className={cx('cube', {\n        'cube--active': type === STATE.PROGRESS,\n        'cube--complete': type === STATE.COMPLETE\n      })}\n    />\n  );\n}\n","import React from 'react';\nimport { connect } from 'dva';\nimport Cube from 'component/cube';\nimport './index.scss';\n\nconst Game = (props) => {\n  const { body } = props;\n\n  return (\n    <div className=\"game\">\n      {body.map((v, k) => <Cube key={k} type={v} />)}\n    </div>\n  );\n}\n\nexport default connect(({\n  home,\n}) => ({\n  body: home.body,\n}))(Game);\n","import React, { useState, useEffect } from 'react';\nimport { connect } from 'dva';\nimport { STATE } from 'config/constant';\nimport store from 'utils/store';\nimport Cube from 'component/cube';\nimport './index.scss';\n\nconst ROW_SIZE = 4;\nconst COL_SIZE = 3;\n\nconst Next = (props) => {\n  const { nextShape } = props;\n\n  const [nextArea, setNextArea] = useState([]);\n\n  useEffect(() => {\n    const { nextShape } = store;\n\n    const nextAreaContent = Array(ROW_SIZE * COL_SIZE).fill(STATE.EMPTY);\n\n    nextShape.forEach((e, i) => {\n      e.forEach((v, k) => {\n        const yIndex = i * (ROW_SIZE - 1);\n        nextAreaContent[yIndex + k] = v ? STATE.COMPLETE : STATE.EMPTY;\n      })\n    });\n\n    setNextArea(nextAreaContent);\n  }, [nextShape]);\n\n  return (\n    <div className=\"next\">\n      {nextArea.map((v, k) => <Cube key={k} type={v} />)}\n    </div>\n  );\n}\n\nexport default connect(({\n  home,\n}) => ({\n  nextShape: home.nextShape,\n}))(Next);\n","import React from 'react';\nimport { connect } from 'dva';\nimport Next from 'component/next';\nimport './index.scss';\n\nconst Info = (props) => {\n  const { score } = props;\n\n  return (\n    <div className=\"info\">\n      <p className=\"info__title\">得分</p>\n      <p>{score}</p>\n      <p className=\"info__title\">下一个</p>\n      <Next />\n    </div>\n  );\n}\n\nexport default connect(({\n  home,\n}) => ({\n  score: home.score,\n}))(Info);\n","import React from 'react';\nimport Game from 'component/game';\nimport Info from 'component/info';\nimport './index.scss';\n\nexport default () => {\n  return (\n    <div className=\"game-area\">\n      <div className=\"game-area__wrap\">\n        <div className=\"game-area__container\">\n          <Game />\n          <Info />\n        </div>\n      </div>\n    </div>\n  );\n}","import React, { useEffect } from 'react';\nimport cx from 'classname';\nimport { COL_SIZE, EVENT_KEY, KEY_CODE_DIRECTION, KEY_CODE_DIRECTION_SEED } from 'config/constant';\nimport { bus } from 'utils/bus';\nimport store from 'utils/store';\nimport { getYStop, checkCollision } from 'utils/shape';\nimport { getShapeLongestRowSide, isEmpty, isMobile } from 'utils/utils';\nimport './index.scss';\n\nconst Btn = (props = {}) => {\n  const { \n    className,\n    text,\n    onTouchStart = () => {},\n  } = props;\n\n  const pushProps = {\n    className: cx('c-btn', className),\n  };\n\n  if (isMobile()) {\n    pushProps.onTouchStart = onTouchStart;\n  } else {\n    pushProps.onMouseDown = onTouchStart;\n  }\n\n  return (\n    <div {...pushProps}>\n      <i className=\"c-btn__icon\" />\n      {text && <p>{text}</p>}\n    </div>\n  );\n};\n\nexport default (props) => {\n  const change = () => {\n    bus.emit(EVENT_KEY.SHAPE_CHANGE);\n  };\n\n  const down = () => {\n    const { shape } = store?.state?.home;\n\n    if (isEmpty(shape)) return;\n\n    store.setY(getYStop() + 1);\n  };\n\n  const handleDirection = (keyCode) => {\n    const { x, y, shape } = store?.state?.home || {};\n\n    const longestSide = getShapeLongestRowSide(shape);\n    const computedX = x + KEY_CODE_DIRECTION_SEED[keyCode];\n\n    // 超小 || 超大 || 发生碰撞 \n    const newX = computedX < 0 || computedX + longestSide > COL_SIZE || checkCollision(computedX, y) ? x : computedX;\n\n    store.setX(newX);\n  };\n\n  const left = () => {\n    handleDirection(KEY_CODE_DIRECTION.LEFT);\n  };\n\n  const right = () => {\n    handleDirection(KEY_CODE_DIRECTION.RIGHT);\n  };\n\n  const start = () => {\n    bus.emit(EVENT_KEY.START_GAME);\n  };\n\n  const reset = () => {\n    bus.emit(EVENT_KEY.RESET_GAME);\n  };\n\n  useEffect(() => {\n    bus.on(KEY_CODE_DIRECTION.SPACE, change);\n    bus.on(KEY_CODE_DIRECTION.DOWN, down);\n    bus.on(KEY_CODE_DIRECTION.LEFT, left);\n    bus.on(KEY_CODE_DIRECTION.RIGHT, right);\n  }, []);\n\n  return (\n    <div className=\"control\">\n      <div>\n        <div className=\"control__core\">\n          <Btn className=\"control__btn--start\" text=\"开始\" onTouchStart={start} />\n          <Btn className=\"control__btn--reset\" text=\"重玩\" onTouchStart={reset} />\n        </div>\n        <Btn className=\"control__btn--change\" text=\"变形(SPACE)\" onTouchStart={change} />\n      </div>\n      <div className=\"control__direction\">\n        <Btn className=\"control__btn--left\" text=\"左移\" onTouchStart={left} />\n        <Btn className=\"control__btn--right\" text=\"右移\" onTouchStart={right} />\n        <Btn className=\"control__btn--down\" text=\"掉落\" onTouchStart={down} />\n      </div>\n    </div>\n  );\n}\n","export default () => {\n  document.addEventListener('gesturestart', (event) => {\n    event.preventDefault();\n  });\n  \n  var lastTouchEnd = 0;\n  document.documentElement.addEventListener('touchend', (event) => {\n    var now = Date.now();\n    if (now - lastTouchEnd <= 300) {\n      event.preventDefault();\n    }\n    lastTouchEnd = now;\n  }, false);\n};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import home from './home';\n\nconst stores = {\n  home,\n};\n\nconst createStore  = (app) => {\n  Object.keys(stores).forEach(e => {\n    app.model(stores[e]);\n  });\n};\n\nexport default createStore;","import { SCORE_SIZE } from 'config/constant';\nimport store from 'utils/store';\n\nexport default {\n  namespace: 'home',\n  state: {\n    x: 0,\n    y: -1,\n    // 得分\n    score: 0,\n    // 当前形状\n    shape: [],\n    // 下一个形状\n    nextShape: [],\n    body: Array(150).fill('0'),\n  },\n  reducers: {\n    updateState(state, { payload = {} }) {\n      return {\n        ...state,\n        ...payload,\n      };\n    },\n  },\n  effects: {\n    *setX({ payload: { x } }, { put }) {\n      yield put({\n        type: 'updateState',\n        payload: { x },\n      });\n    },\n\n    *setY({ payload: { y } }, { put }) {\n      yield put({\n        type: 'updateState',\n        payload: { y },\n      });\n    },\n\n    *updateScore({ payload: { size = 0 } }, { put }) {\n      const score = store.state.home.score + size * SCORE_SIZE;\n\n      yield put({\n        type: 'updateState',\n        payload: { score },\n      });\n    },\n  },\n}\n","import React from 'react';\nimport dva from 'dva';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport store from './store';\nimport './index.css';\n\nconst app = dva();\n\nwindow._dva = app;\n\nstore(app);\n\napp.router(() => <App />);\napp.start('#root');\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}